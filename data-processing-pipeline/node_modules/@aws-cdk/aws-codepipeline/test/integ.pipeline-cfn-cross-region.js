"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cloudformation = require("@aws-cdk/aws-cloudformation");
const s3 = require("@aws-cdk/aws-s3");
const cdk = require("@aws-cdk/cdk");
const codepipeline = require("../lib");
const app = new cdk.App();
const region = 'us-west-2'; // hardcode the region
const stack = new cdk.Stack(app, 'aws-cdk-codepipeline-cloudformation-cross-region', {
    env: {
        region,
    },
});
const bucket = new s3.Bucket(stack, 'MyBucket', {
    versioned: true,
    removalPolicy: cdk.RemovalPolicy.Destroy,
});
const pipeline = new codepipeline.Pipeline(stack, 'MyPipeline', {
    artifactBucket: bucket,
});
const sourceStage = pipeline.addStage('Source');
const sourceAction = bucket.addToPipeline(sourceStage, 'S3', {
    bucketKey: 'some/path',
});
const cfnStage = pipeline.addStage('CFN');
new cloudformation.PipelineCreateUpdateStackAction(stack, 'CFN_Deploy', {
    stage: cfnStage,
    stackName: 'aws-cdk-codepipeline-cross-region-deploy-stack',
    templatePath: sourceAction.outputArtifact.atPath('template.yml'),
    adminPermissions: false,
    region,
});
app.run();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWcucGlwZWxpbmUtY2ZuLWNyb3NzLXJlZ2lvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVnLnBpcGVsaW5lLWNmbi1jcm9zcy1yZWdpb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw4REFBK0Q7QUFDL0Qsc0NBQXVDO0FBQ3ZDLG9DQUFxQztBQUNyQyx1Q0FBd0M7QUFFeEMsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7QUFFMUIsTUFBTSxNQUFNLEdBQUcsV0FBVyxDQUFDLENBQUMsc0JBQXNCO0FBQ2xELE1BQU0sS0FBSyxHQUFHLElBQUksR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsa0RBQWtELEVBQUU7SUFDbkYsR0FBRyxFQUFFO1FBQ0gsTUFBTTtLQUNQO0NBQ0YsQ0FBQyxDQUFDO0FBRUgsTUFBTSxNQUFNLEdBQUcsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxVQUFVLEVBQUU7SUFDOUMsU0FBUyxFQUFFLElBQUk7SUFDZixhQUFhLEVBQUUsR0FBRyxDQUFDLGFBQWEsQ0FBQyxPQUFPO0NBQ3pDLENBQUMsQ0FBQztBQUVILE1BQU0sUUFBUSxHQUFHLElBQUksWUFBWSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUUsWUFBWSxFQUFFO0lBQzlELGNBQWMsRUFBRSxNQUFNO0NBQ3ZCLENBQUMsQ0FBQztBQUVILE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDaEQsTUFBTSxZQUFZLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQyxXQUFXLEVBQUUsSUFBSSxFQUFFO0lBQzNELFNBQVMsRUFBRSxXQUFXO0NBQ3ZCLENBQUMsQ0FBQztBQUVILE1BQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDMUMsSUFBSSxjQUFjLENBQUMsK0JBQStCLENBQUMsS0FBSyxFQUFFLFlBQVksRUFBRTtJQUN0RSxLQUFLLEVBQUUsUUFBUTtJQUNmLFNBQVMsRUFBRSxnREFBZ0Q7SUFDM0QsWUFBWSxFQUFFLFlBQVksQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQztJQUNoRSxnQkFBZ0IsRUFBRSxLQUFLO0lBQ3ZCLE1BQU07Q0FDUCxDQUFDLENBQUM7QUFFSCxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2xvdWRmb3JtYXRpb24gPSByZXF1aXJlKCdAYXdzLWNkay9hd3MtY2xvdWRmb3JtYXRpb24nKTtcbmltcG9ydCBzMyA9IHJlcXVpcmUoJ0Bhd3MtY2RrL2F3cy1zMycpO1xuaW1wb3J0IGNkayA9IHJlcXVpcmUoJ0Bhd3MtY2RrL2NkaycpO1xuaW1wb3J0IGNvZGVwaXBlbGluZSA9IHJlcXVpcmUoJy4uL2xpYicpO1xuXG5jb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xuXG5jb25zdCByZWdpb24gPSAndXMtd2VzdC0yJzsgLy8gaGFyZGNvZGUgdGhlIHJlZ2lvblxuY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKGFwcCwgJ2F3cy1jZGstY29kZXBpcGVsaW5lLWNsb3VkZm9ybWF0aW9uLWNyb3NzLXJlZ2lvbicsIHtcbiAgZW52OiB7XG4gICAgcmVnaW9uLFxuICB9LFxufSk7XG5cbmNvbnN0IGJ1Y2tldCA9IG5ldyBzMy5CdWNrZXQoc3RhY2ssICdNeUJ1Y2tldCcsIHtcbiAgdmVyc2lvbmVkOiB0cnVlLFxuICByZW1vdmFsUG9saWN5OiBjZGsuUmVtb3ZhbFBvbGljeS5EZXN0cm95LFxufSk7XG5cbmNvbnN0IHBpcGVsaW5lID0gbmV3IGNvZGVwaXBlbGluZS5QaXBlbGluZShzdGFjaywgJ015UGlwZWxpbmUnLCB7XG4gIGFydGlmYWN0QnVja2V0OiBidWNrZXQsXG59KTtcblxuY29uc3Qgc291cmNlU3RhZ2UgPSBwaXBlbGluZS5hZGRTdGFnZSgnU291cmNlJyk7XG5jb25zdCBzb3VyY2VBY3Rpb24gPSBidWNrZXQuYWRkVG9QaXBlbGluZShzb3VyY2VTdGFnZSwgJ1MzJywge1xuICBidWNrZXRLZXk6ICdzb21lL3BhdGgnLFxufSk7XG5cbmNvbnN0IGNmblN0YWdlID0gcGlwZWxpbmUuYWRkU3RhZ2UoJ0NGTicpO1xubmV3IGNsb3VkZm9ybWF0aW9uLlBpcGVsaW5lQ3JlYXRlVXBkYXRlU3RhY2tBY3Rpb24oc3RhY2ssICdDRk5fRGVwbG95Jywge1xuICBzdGFnZTogY2ZuU3RhZ2UsXG4gIHN0YWNrTmFtZTogJ2F3cy1jZGstY29kZXBpcGVsaW5lLWNyb3NzLXJlZ2lvbi1kZXBsb3ktc3RhY2snLFxuICB0ZW1wbGF0ZVBhdGg6IHNvdXJjZUFjdGlvbi5vdXRwdXRBcnRpZmFjdC5hdFBhdGgoJ3RlbXBsYXRlLnltbCcpLFxuICBhZG1pblBlcm1pc3Npb25zOiBmYWxzZSxcbiAgcmVnaW9uLFxufSk7XG5cbmFwcC5ydW4oKTtcbiJdfQ==